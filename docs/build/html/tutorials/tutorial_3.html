

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The distributions of Moe &amp; Di Stefano (2017) &mdash; Dyad 0.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=7026087e"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dyad API" href="../api_reference/index.html" />
    <link rel="prev" title="Synthesizing a population of binary stars" href="tutorial_2.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Dyad
              <img src="../_static/dyad_logo_white.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/what_is_dyad.html">What is Dyad?</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial_1.html">Representing a Keplerian system</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_1.html#representing-a-binary-system">Representing a binary system</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_2.html">Synthesizing a population of binary stars</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The distributions of Moe &amp; Di Stefano (2017)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-probability-density-functions">The probability density functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#log-period">Log-period</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mass-ratio">Mass ratio</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eccentricity">Eccentricity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#a-complete-population">A complete population</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/index.html">Dyad API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../community_guidelines/index.html">Contribute to Dyad</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community_guidelines/index.html#report-problems-with-dyad">Report problems with Dyad</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community_guidelines/index.html#seek-support">Seek support</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Dyad</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">The distributions of Moe &amp; Di Stefano (2017)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/tutorial_3.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="the-distributions-of-moe-di-stefano-2017">
<span id="tutorial-3"></span><h1>The distributions of Moe &amp; Di Stefano (2017)<a class="headerlink" href="#the-distributions-of-moe-di-stefano-2017" title="Link to this heading"></a></h1>
<p>Moe and Di Stefano <a class="reference internal" href="#ms17" id="id1"><span>[MS17]</span></a> reported empirical distributions for the period, <span class="math notranslate nohighlight">\(P\)</span>, mass-ratio, <span class="math notranslate nohighlight">\(Q\)</span>, and eccentricity, <span class="math notranslate nohighlight">\(E\)</span>, of binary stars in the solar neighbourhood.
Their catalogue included data for binary systems with primary stars of five spectral types, namely</p>
<ul class="simple">
<li><p>solar, with <span class="math notranslate nohighlight">\(m_{1}/\mathrm{M}_{\odot} \in [0.8, 1.2)\)</span>,</p></li>
<li><p>A and late-B, with <span class="math notranslate nohighlight">\(m_{1}/\mathrm{M}_{\odot} \in [2, 5)\)</span>,</p></li>
<li><p>mid-B, with <span class="math notranslate nohighlight">\(m_{1}/\mathrm{M}_{\odot} \in [5, 9)\)</span>,</p></li>
<li><p>early B, with <span class="math notranslate nohighlight">\(m_{1}/\mathrm{M}_{\odot} \in [9, 16)\)</span>, and</p></li>
<li><p>O, with <span class="math notranslate nohighlight">\(m_{1}/\mathrm{M}_{\odot} \in [16, 40]\)</span>,</p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(m_{1}\)</span> is the mass of the primary star.</p>
<p>The period is dependent on primary mass while the mass ratio and eccentricity are dependent on both period and primary mass.
Alongside the empirical distributions Moe and Di Stefano gave formulae for the corresponding probability density functions, which Dyad uses to implement the random variables
<a class="reference internal" href="../generated/generated/generated/dyad.stats.log_period.moe2017.html#dyad.stats.log_period.moe2017" title="dyad.stats.log_period.moe2017"><code class="xref py py-class docutils literal notranslate"><span class="pre">dyad.stats.log_period.moe2017</span></code></a>,
<a class="reference internal" href="../generated/generated/generated/dyad.stats.period.moe2017.html#dyad.stats.period.moe2017" title="dyad.stats.period.moe2017"><code class="xref py py-class docutils literal notranslate"><span class="pre">dyad.stats.period.moe2017</span></code></a>,
<a class="reference internal" href="../generated/generated/generated/dyad.stats.mass_ratio.moe2017.html#dyad.stats.mass_ratio.moe2017" title="dyad.stats.mass_ratio.moe2017"><code class="xref py py-class docutils literal notranslate"><span class="pre">dyad.stats.mass_ratio.moe2017</span></code></a>, and
<a class="reference internal" href="../generated/generated/generated/dyad.stats.eccentricity.moe2017.html#dyad.stats.eccentricity.moe2017" title="dyad.stats.eccentricity.moe2017"><code class="xref py py-class docutils literal notranslate"><span class="pre">dyad.stats.eccentricity.moe2017</span></code></a>.
Since these are dependent on other random variables we must use their shape parameters to fully specify them.
The unit of period is <span class="math notranslate nohighlight">\(\mathrm{d}\)</span> and the unit of mass is <span class="math notranslate nohighlight">\(\mathrm{M}_{\odot}\)</span>.</p>
<section id="the-probability-density-functions">
<h2>The probability density functions<a class="headerlink" href="#the-probability-density-functions" title="Link to this heading"></a></h2>
<p>Let us plot the PDFs of each random variable in turn.
In each case we will consider the average primary mass for each spectral type, namely <span class="math notranslate nohighlight">\(m_{1}/\mathrm{M}_{\odot} = 1, 3.5, 7, 12, 28\)</span>, which we can specify now.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mf">28.</span><span class="p">])</span>
</pre></div>
</div>
<section id="log-period">
<h3>Log-period<a class="headerlink" href="#log-period" title="Link to this heading"></a></h3>
<p>Let us evaluate the conditional PDF of log-period given primary mass, <span class="math notranslate nohighlight">\(f_{\log_{10}(P)|M_{1}}\)</span>, which is nonzero between <span class="math notranslate nohighlight">\(\log_{10}(P/\mathrm{d}) = 0.2\)</span> and <span class="math notranslate nohighlight">\(\log_{10}(P/\mathrm{d}) = 8\)</span>
where <span class="math notranslate nohighlight">\(M_{1}/\mathrm{M}_{\odot} \in [0.8, 40]\)</span>.
Dyad implements the log-period random variable using the class <a class="reference internal" href="../generated/generated/generated/dyad.stats.log_period.moe2017.html#dyad.stats.log_period.moe2017" title="dyad.stats.log_period.moe2017"><code class="xref py py-class docutils literal notranslate"><span class="pre">dyad.stats.log_period.moe2017</span></code></a>, which has shape parameter <code class="docutils literal notranslate"><span class="pre">primary_mass</span></code>.</p>
<p>To allow for broadcasting we must increase the dimension of <code class="docutils literal notranslate"><span class="pre">m_1</span></code> using the notation <code class="docutils literal notranslate"><span class="pre">m_1[:,None]</span></code> to create a new axis.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dyad.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">9.</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">log_period</span><span class="o">.</span><span class="n">moe2017</span><span class="p">(</span><span class="n">m_1</span><span class="p">[:,</span><span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">log_p</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let us plot these values.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="sa">r</span><span class="s2">&quot;$M_</span><span class="si">{1}</span><span class="s2"> = 1\mathrm</span><span class="si">{M}</span><span class="s2">_{\odot}$&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="sa">r</span><span class="s2">&quot;$M_</span><span class="si">{1}</span><span class="s2"> = 3.5\mathrm</span><span class="si">{M}</span><span class="s2">_{\odot}$&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="sa">r</span><span class="s2">&quot;$M_</span><span class="si">{1}</span><span class="s2"> = 7\mathrm</span><span class="si">{M}</span><span class="s2">_{\odot}$&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="sa">r</span><span class="s2">&quot;$M_</span><span class="si">{1}</span><span class="s2"> = 12\mathrm</span><span class="si">{M}</span><span class="s2">_{\odot}$&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="sa">r</span><span class="s2">&quot;$M_</span><span class="si">{1}</span><span class="s2"> = 28\mathrm</span><span class="si">{M}</span><span class="s2">_{\odot}$&quot;</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;magenta&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="p">(</span><span class="n">f_i</span><span class="p">,</span> <span class="n">label_i</span><span class="p">,</span> <span class="n">color_i</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_p</span><span class="p">,</span> <span class="n">f_i</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_i</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\log_</span><span class="si">{10}</span><span class="s2">(p/\mathrm</span><span class="si">{d}</span><span class="s2">)$&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{log_</span><span class="si">{10}</span><span class="s2">(P)}$&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id3" style="width: 75%">
<span id="logperiod"></span><img alt="../_images/moe2017_pdf_logperiod.jpg" src="../_images/moe2017_pdf_logperiod.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">The conditional PDF of log-period, <span class="math notranslate nohighlight">\(\log_{10}(P)\)</span> given primary mass, <span class="math notranslate nohighlight">\(M_{1}\)</span>.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>We may also evaluate the conditional PDF of period (rather than log-period)  given primary mass, <span class="math notranslate nohighlight">\(f_{P|M_{1}}\)</span>, which is nonzero between <span class="math notranslate nohighlight">\(P/\mathrm{d} = 10^{0.2}\)</span> and <span class="math notranslate nohighlight">\(P/\mathrm{d} = 10^{8}\)</span>
where <span class="math notranslate nohighlight">\(M_{1}/\mathrm{M}_{\odot} \in [0.8, 40]\)</span>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">9.</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">moe2017</span><span class="p">(</span><span class="n">m_1</span><span class="p">[:,</span><span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="mass-ratio">
<h3>Mass ratio<a class="headerlink" href="#mass-ratio" title="Link to this heading"></a></h3>
<p>Let us evaluate the conditional PDF of mass ratio given log-period and primary mass, <span class="math notranslate nohighlight">\(f_{Q|\log_{10}(P), M_{1}}\)</span>, which is nonzero between <span class="math notranslate nohighlight">\(q = 0.1\)</span> and <span class="math notranslate nohighlight">\(q = 1\)</span>, where <span class="math notranslate nohighlight">\(\log_{10}(P/\mathrm{d}) \in [0.2, 8]\)</span> and <span class="math notranslate nohighlight">\(M_{1}/\mathrm{M}_{\odot} \in [0.8, 40]\)</span>.
Dyad implements the mass-ratio random variable using the class <a class="reference internal" href="../generated/generated/generated/dyad.stats.mass_ratio.moe2017.html#dyad.stats.mass_ratio.moe2017" title="dyad.stats.mass_ratio.moe2017"><code class="xref py py-class docutils literal notranslate"><span class="pre">dyad.stats.mass_ratio.moe2017</span></code></a>, which has shape parameters <code class="docutils literal notranslate"><span class="pre">log10_period</span></code> and <code class="docutils literal notranslate"><span class="pre">primary_mass</span></code>.</p>
<p>This PDF is qualitatively different for short- and long-period binary systems.
For short-period systems it is approximately constant except for an excess of twins, this excess being greater for systems with low-mass primary stars than it is for systems with high-mass primary stars.
For long-period systems with high-mass primary stars it is a decreasing function of <span class="math notranslate nohighlight">\(q\)</span>.
For long-period systems with low-mass primary stars it has a mode at <span class="math notranslate nohighlight">\(q = 0.3\)</span>.</p>
<p>Let us consider the minimum and maximum allowed log-periods, <span class="math notranslate nohighlight">\(0.2\)</span> and <span class="math notranslate nohighlight">\(8\)</span>.
First, the case of <span class="math notranslate nohighlight">\(\log_{10}(P/\mathrm{d}) = 0.2\)</span>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mass_ratio</span><span class="o">.</span><span class="n">moe2017</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">m_1</span><span class="p">[:,</span><span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<p>Which we may plot.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="p">(</span><span class="n">f_i</span><span class="p">,</span> <span class="n">label_i</span><span class="p">,</span> <span class="n">color_i</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">f_i</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_i</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$q$&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_Q$&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id4" style="width: 75%">
<span id="mass-ratio-short-period"></span><img alt="../_images/moe2017_pdf_mass_ratio_short_period.jpg" src="../_images/moe2017_pdf_mass_ratio_short_period.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">The PDF of mass ratio, <span class="math notranslate nohighlight">\(Q\)</span>, given log-period, <span class="math notranslate nohighlight">\(\log_{10}(P/\mathrm{d}) = 0.2\)</span> and primary mass <span class="math notranslate nohighlight">\(M_{1}\)</span>.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Second, the case of <span class="math notranslate nohighlight">\(\log_{10}(P/\mathrm{d}) = 8\)</span>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mass_ratio</span><span class="o">.</span><span class="n">moe2017</span><span class="p">(</span><span class="mf">8.</span><span class="p">,</span> <span class="n">m_1</span><span class="p">[:,</span><span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<p>Which we may again plot.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="p">(</span><span class="n">f_i</span><span class="p">,</span> <span class="n">label_i</span><span class="p">,</span> <span class="n">color_i</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">f_i</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_i</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$q$&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_Q$&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id5" style="width: 75%">
<span id="mass-ratio-long-period"></span><img alt="../_images/moe2017_pdf_mass_ratio_long_period.jpg" src="../_images/moe2017_pdf_mass_ratio_long_period.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 9 </span><span class="caption-text">The conditional PDF of mass ratio, <span class="math notranslate nohighlight">\(Q\)</span>, given log-period, <span class="math notranslate nohighlight">\(\log_{10}(P/\mathrm{d}) = 8\)</span> and primary mass <span class="math notranslate nohighlight">\(M_{1}\)</span>.</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="eccentricity">
<h3>Eccentricity<a class="headerlink" href="#eccentricity" title="Link to this heading"></a></h3>
<p>Let us evaluate the conditional PDF of mass ratio given log-period and primary mass, <span class="math notranslate nohighlight">\(f_{E|\log_{10}(P), M_{1}}\)</span>, which is nonzero between <span class="math notranslate nohighlight">\(e = 0.\)</span> and <span class="math notranslate nohighlight">\(e_{\max}\)</span>, where <span class="math notranslate nohighlight">\(e_{\max}\)</span> is an increasing function of log-period and where <span class="math notranslate nohighlight">\(\log_{10}(P/\mathrm{d}) \in [0.9375, 8]\)</span> and <span class="math notranslate nohighlight">\(M_{1}/\mathrm{M}_{\odot} \in [0.8, 40]\)</span>.
Dyad implements the eccentricity random variable using the class <a class="reference internal" href="../generated/generated/generated/dyad.stats.eccentricity.moe2017.html#dyad.stats.eccentricity.moe2017" title="dyad.stats.eccentricity.moe2017"><code class="xref py py-class docutils literal notranslate"><span class="pre">dyad.stats.eccentricity.moe2017</span></code></a>, which has shape parameters <code class="docutils literal notranslate"><span class="pre">log10_period</span></code> and <code class="docutils literal notranslate"><span class="pre">primary_mass</span></code>.
The minimum period is known as the 'circularization period',
If a binary system has a period shorter than the circularization period then its eccentricity is zero.
Dyad uses a circularation period of <span class="math notranslate nohighlight">\(0.9375\)</span>, which differs from the value of <span class="math notranslate nohighlight">\(0.5\)</span> used by Moe and Di Stefano in order to ensure that the PDF always has finite integral.
For a full discussion, see the API documentation.</p>
<p>The PDF is qualitatively different for short- and long-period binary systems.
For short-period systems with small primary star masses it is a descreasing function of <span class="math notranslate nohighlight">\(q\)</span>.
For short-period systems with large primary star masses it is an increasing function of <span class="math notranslate nohighlight">\(q\)</span>.
For long-period systems it is also an increasing function of <span class="math notranslate nohighlight">\(q\)</span>.</p>
<p>Let us consider the log-periods, <span class="math notranslate nohighlight">\(\log_{10}(P/\mathrm{d}) = 1\)</span> and <span class="math notranslate nohighlight">\(\log_{10}(P/\mathrm{d}) = 8\)</span>.
First, evaluate the PDF for <span class="math notranslate nohighlight">\(\log_{10}(P/\mathrm{d}) = 1\)</span>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">eccentricity</span><span class="o">.</span><span class="n">moe2017</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">m_1</span><span class="p">[:,</span><span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<p>And plot it.</p>
<figure class="align-center" id="id6" style="width: 75%">
<span id="eccentricity-short-period"></span><img alt="../_images/moe2017_pdf_eccentricity_short_period.jpg" src="../_images/moe2017_pdf_eccentricity_short_period.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">The PDF of eccentricity, <span class="math notranslate nohighlight">\(E\)</span>, given log-period, <span class="math notranslate nohighlight">\(\log_{10}(P/\mathrm{d}) = 1\)</span> and primary mass, <span class="math notranslate nohighlight">\(M_{1}\)</span>.</span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="p">(</span><span class="n">f_i</span><span class="p">,</span> <span class="n">label_i</span><span class="p">,</span> <span class="n">color_i</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">f_i</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_i</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$e$&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_E$&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Second, evaluate the PDF for <span class="math notranslate nohighlight">\(\log_{10}(P/\mathrm{d}) = 8\)</span>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">eccentricity</span><span class="o">.</span><span class="n">moe2017</span><span class="p">(</span><span class="mf">8.</span><span class="p">,</span> <span class="n">m_1</span><span class="p">[:,</span><span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<p>And again plot it.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="p">(</span><span class="n">f_i</span><span class="p">,</span> <span class="n">label_i</span><span class="p">,</span> <span class="n">color_i</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">f_i</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_i</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$e$&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_E$&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id7" style="width: 75%">
<span id="eccentricity-long-period"></span><img alt="../_images/moe2017_pdf_eccentricity_long_period.jpg" src="../_images/moe2017_pdf_eccentricity_long_period.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">The PDF of eccentricity, <span class="math notranslate nohighlight">\(E\)</span>, given log-period, <span class="math notranslate nohighlight">\(\log_{10}(P/\mathrm{d}) = 8\)</span> and primary mass, <span class="math notranslate nohighlight">\(M_{1}\)</span>.</span><a class="headerlink" href="#id7" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="a-complete-population">
<h2>A complete population<a class="headerlink" href="#a-complete-population" title="Link to this heading"></a></h2>
<p>Let us now synthesize a population of binary systems.
We will use the primary-constrained pairing method to synthesize the primary- and secondary-star masses <a class="reference internal" href="#k09" id="id2"><span>[K09]</span></a>.
According to this method we synthesize the primary-star star mass assuming that it is distributed according to the initial mass function and then synthesize the secondary-star mass using the conditional distribution of secondary-star mass given primary-star mass.</p>
<p>First, specify a sample size.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_binary</span> <span class="o">=</span> <span class="mi">10_000</span>
</pre></div>
</div>
<p>And sample the primary mass using a Salpeter random variable on the interval <span class="math notranslate nohighlight">\(0.8, 40\)</span>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m_1</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">salpeter1955</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">40.</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n_binary</span><span class="p">)</span>
</pre></div>
</div>
<p>Next sample the period.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">log_p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">log_period</span><span class="o">.</span><span class="n">moe2017</span><span class="p">(</span><span class="n">m_1</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">**</span><span class="n">log_p</span>
</pre></div>
</div>
<p>And the mass ratio. (This can be time consuming. A sample of size <span class="math notranslate nohighlight">\(100\,000\)</span> may take several minutes or more to be generated.)</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mass_ratio</span><span class="o">.</span><span class="n">moe2017</span><span class="p">(</span><span class="n">log_p</span><span class="p">,</span> <span class="n">m_1</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>
</pre></div>
</div>
<p>Now sample the eccentricity, remembering that all systems with periods shorter than the circularization period, when <span class="math notranslate nohighlight">\(\log_{10}(P) = 0.9375\)</span>, have eccentricities of zero.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_binary</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">log_p</span> <span class="o">&gt;</span> <span class="mf">0.9375</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">eccentricity</span><span class="o">.</span><span class="n">moe2017</span><span class="p">(</span><span class="n">log_p</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">m_1</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>
</pre></div>
</div>
<p>Finally, sample the longitude of the ascending node, inclination, and argument of periapsis.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Omega</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">longitude_of_ascending_node</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n_binary</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">inclination</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n_binary</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omega</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">argument_of_pericentre</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n_binary</span><span class="p">)</span>
</pre></div>
</div>
<p>As before, the class <a class="reference internal" href="../generated/generated/dyad.TwoBody.html#dyad.TwoBody" title="dyad.TwoBody"><code class="xref py py-class docutils literal notranslate"><span class="pre">dyad.TwoBody</span></code></a> can serve as a container for these values.
First convert the periods to their equivalent primary-star semimajor axes.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dyad</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">dyad</span><span class="o">.</span><span class="n">semimajor_axis_from_period</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">m_1</span><span class="p">,</span> <span class="n">m_1</span><span class="o">*</span><span class="n">q</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_1</span> <span class="o">=</span> <span class="n">dyad</span><span class="o">.</span><span class="n">primary_semimajor_axis_from_semimajor_axis</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<p>And instantiate a <a class="reference internal" href="../generated/generated/dyad.TwoBody.html#dyad.TwoBody" title="dyad.TwoBody"><code class="xref py py-class docutils literal notranslate"><span class="pre">dyad.TwoBody</span></code></a> object.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">binary</span> <span class="o">=</span> <span class="n">dyad</span><span class="o">.</span><span class="n">TwoBody</span><span class="p">(</span><span class="n">m_1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a_1</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Omega</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span>
</pre></div>
</div>
<p>Before, we inspected the state of a single member of this population for a given true anomaly.
This time, let us compute the speeds and radii of all primary and secondary stars and plot their histograms.
First, sample the true anomaly.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">true_anomaly</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>
</pre></div>
</div>
<p>And compute the primary and secondary radii at these true anomalies.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r_1</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">primary</span><span class="o">.</span><span class="n">radius</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_2</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">secondary</span><span class="o">.</span><span class="n">radius</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
<p>Now generate the histograms.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edge_r1</span><span class="p">,</span> <span class="n">count_r1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">r_1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edge_r2</span><span class="p">,</span> <span class="n">count_r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">r_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
</pre></div>
</div>
<p>And finally plot them.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">stairs</span><span class="p">(</span><span class="n">edge_r1</span><span class="p">,</span> <span class="n">count_r1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;primary&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">stairs</span><span class="p">(</span><span class="n">edge_r2</span><span class="p">,</span> <span class="n">count_r2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;primary&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$r/\mathrm</span><span class="si">{AU}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\nu$&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id8" style="width: 75%">
<span id="radii"></span><img alt="../_images/moe2017_sample_radius.jpg" src="../_images/moe2017_sample_radius.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">The histograms of primary and secondary star radii.</span><a class="headerlink" href="#id8" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Now compute the primary and secondary speeds.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v_1</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">primary</span><span class="o">.</span><span class="n">speed</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v_2</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">secondary</span><span class="o">.</span><span class="n">speed</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
<p>Again generate the histograms.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edge_v1</span><span class="p">,</span> <span class="n">count_v1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">r_1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edge_v2</span><span class="p">,</span> <span class="n">count_v2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">r_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
</pre></div>
</div>
<p>And again plot them.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">stairs</span><span class="p">(</span><span class="n">edge_v1</span><span class="p">,</span> <span class="n">count_v1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;primary&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">stairs</span><span class="p">(</span><span class="n">edge_v2</span><span class="p">,</span> <span class="n">count_v2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;primary&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$v/\mathrm</span><span class="si">{km}</span><span class="s2">~\mathrm</span><span class="si">{s}</span><span class="s2">^{-1}$&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\nu$&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id9" style="width: 75%">
<span id="speed"></span><img alt="../_images/moe2017_sample_speed.jpg" src="../_images/moe2017_sample_speed.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">The histograms of primary and secondary star speeds.</span><a class="headerlink" href="#id9" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<div role="list" class="citation-list">
<div class="citation" id="ms17" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">MS17</a><span class="fn-bracket">]</span></span>
<p>Moe, Maxwell, and Rosanne Di Stefano. 2017. 'Mind your Ps and Qs:
the interrelation between period (P) and mass-ratio (Q)
distributions of binary stars.' <em>The Astrophysical Journal
Supplement Series</em> 230 (2): 15.</p>
</div>
<div class="citation" id="k09" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">K09</a><span class="fn-bracket">]</span></span>
<p>Kouwenhoven, M. B. N. et al. 2009. 'Exploring the consequences of pairing
algorithms for binary stars.'. <em>Astronomy &amp; Astrophysics</em> 493 (3):
979.</p>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial_2.html" class="btn btn-neutral float-left" title="Synthesizing a population of binary stars" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../api_reference/index.html" class="btn btn-neutral float-right" title="Dyad API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Amery Gration.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>